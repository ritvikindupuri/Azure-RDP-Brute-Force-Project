# Azure Cloud SIEM: RDP Brute Force Detection with Microsoft Sentinel

This project demonstrates the design and implementation of a cloud-native security pipeline in Microsoft Azure to detect and investigate RDP brute force attacks. It showcases an end-to-end Security Operations Center (SOC) workflow, from log ingestion and rule creation to a final, actionable incident in Microsoft Sentinel.

The entire lab was built using Azure-native tools, highlighting a practical approach to threat detection in a modern cloud environment.

---
## Detection Pipeline Architecture

The architecture follows a logical, event-driven flow. An attacker's actions against a public-facing Windows VM are logged, collected, and analyzed by Microsoft Sentinel to generate a high-fidelity security incident.

1.  **Attack Simulation:** A local machine initiates repeated, failed RDP connection attempts against the Azure Windows VM's public IP.
2.  **Log Generation:** The Windows VM records each failed logon as a Security Event (Event ID 4625).
3.  **Log Ingestion:** The Azure Monitor Agent (AMA) on the VM collects these events and forwards them to a central Log Analytics Workspace.
4.  **Detection & Alerting:** A custom Analytic Rule in Microsoft Sentinel, written in KQL, runs on a schedule, querying the logs for brute force patterns. When the pattern is detected, Sentinel creates an incident.

<img src="./assets/Architecture Diagram.png" width="800" alt="Architecture diagram of the brute force detection pipeline">
*<p align="center">Figure 1: The visual flow from attack simulation to incident alert in Sentinel.</p>*

---
## The Incident Lifecycle: From Ingestion to Triage

The project followed the key stages of a real-world incident response process within Sentinel.

### Step 1: Data Ingestion & Collection
The foundation of any SIEM is reliable log collection. A Data Connector was configured in Microsoft Sentinel to ingest Windows Security Events from the target VM via the Azure Monitor Agent (AMA), ensuring a steady stream of telemetry for analysis.

<img src="./assets/Data Connectior.png" width="800" alt="Sentinel Data Connectors page showing Windows Security Events being collected">
*<p align="center">Figure 2: The active data connector for Windows Security Events.</p>*

### Step 2: The Detection Logic (KQL & Log Analysis)
The core of the detection is a custom Analytic Rule built with **Kusto Query Language (KQL)**. This rule queries the Log Analytics Workspace for a high number of failed logon events (Event ID 4625) from a single source IP in a short time frame. The screenshot below shows the underlying `SecurityAlert` data generated by this rule.

<img src="./assets/Brute Force Alert.jpg" width="800" alt="Log Analytics view showing the KQL query and the resulting security alerts">
*<p align="center">Figure 3: The raw alert data and KQL query results in Log Analytics.</p>*

### Step 3: The Incident Alert (Triage)
When the analytic rule's conditions are met, Sentinel automatically creates and triages a new incident. This is the final, actionable output that a SOC analyst would investigate. The incident below, with a **Medium** severity, confirms that the pipeline successfully detected and flagged the simulated brute force attack.

<img src="./assets/Brute Force rule.png" width="800" alt="Microsoft Sentinel Incidents page showing the Brute Force detection incident">
*<p align="center">Figure 4: The final "Brute Force detection" incident in the Sentinel queue.</p>*

---
## Skills & Technologies Demonstrated

* **Microsoft Sentinel:** SIEM deployment, data connectors, analytic rules, and incident management.
* **Microsoft Azure:** Provisioning and managing Windows VMs, Log Analytics Workspaces, and networking.
* **Kusto Query Language (KQL):** Writing custom queries to detect specific threat patterns from raw log data.
* **Threat Detection Engineering:** Designing and implementing rules to detect attacker TTPs (Tactics, Techniques, and Procedures).
* **Incident Response:** Simulating a SOC workflow from log collection to final incident triage.
* **Log Analysis:** Interpreting Windows Security Events (Event ID 4625) for security investigations.
